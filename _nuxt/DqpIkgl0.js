import{_ as D,r,t as _,z as a,A as s,v as g,ao as I,x as i,aS as L,aa as k,bg as G,B as f,a_ as T,bh as J,bi as O,y as W}from"./BJ4U74QN.js";import{E as $,x as j,A as H,y as X,z as Z}from"./VBWnuYbd.js";import{E as q}from"./BJ1AU_lb.js";import{E as K}from"./BpiaDATT.js";import{E as Q}from"./D2dEMYzV.js";const Y={class:"container"},ee={key:0,class:"text-center"},te={key:0,class:"text-center"},ae={key:1,class:"text-center"},le={key:2,class:"image-container text-center"},oe={class:"text-gray-600"},se=10*1024*1024,ne={__name:"resize",setup(re){r(null);const u=r(""),x=r(""),c=r(100),d=r(0),m=r(0),h=r(0),E=r(0),v=r(!1),n=r(""),b=["image/jpeg","image/png","image/webp"],C=t=>{const e=t.raw;e&&U(e)},S=t=>b.includes(t.type)?t.size>se?(n.value="图片大小不能超过 10MB",!1):(n.value="",!0):(n.value="请上传 JPG、PNG 或 WebP 格式的图片",!1),U=t=>{if(!S(t))return;v.value=!0,n.value="";const e=new FileReader;e.onload=l=>{const o=new Image;o.onload=()=>{h.value=o.width,E.value=o.height,d.value=o.width,m.value=o.height,c.value=100,v.value=!1},o.onerror=()=>{n.value="图片加载失败，请重试",v.value=!1},o.src=l.target.result,u.value=l.target.result,x.value=l.target.result},e.onerror=()=>{n.value="图片读取失败，请重试",v.value=!1},e.readAsDataURL(t)},z=()=>{d.value=Math.round(h.value*c.value/100),m.value=Math.round(E.value*c.value/100);const t=document.createElement("canvas");t.width=d.value,t.height=m.value;const e=t.getContext("2d"),l=new Image;l.onload=()=>{e.drawImage(l,0,0,d.value,m.value),u.value=t.toDataURL("image/png")},l.src=x.value},F=()=>{const t=document.createElement("canvas");t.width=d.value,t.height=m.value;const e=t.getContext("2d"),l=new Image;l.onload=()=>{e.drawImage(l,0,0,d.value,m.value);const o=document.createElement("a");o.download="resized-image.png",o.href=t.toDataURL("image/png"),o.click()},l.src=u.value};return(t,e)=>{const l=L,o=j,P=q,w=H,R=K,V=Q,y=O,A=J,B=Z,M=X,N=$;return g(),_("div",Y,[a(N,null,{header:s(()=>e[2]||(e[2]=[i("div",{class:"text-center"},[i("span",{class:"text-xl font-medium"},"图片尺寸调整")],-1)])),default:s(()=>[a(o,{class:"upload-area",drag:"","auto-upload":!1,"show-file-list":!1,accept:"image/*","on-change":C},{trigger:s(()=>[!u.value&&!v.value&&!n.value?(g(),_("div",ee,[a(l,{class:"el-icon--upload mx-auto block"},{default:s(()=>[a(k(G))]),_:1}),e[3]||(e[3]=i("div",{class:"el-upload__text"},[f(" 拖拽图片到此处或 "),i("em",null,"点击上传")],-1)),e[4]||(e[4]=i("div",{class:"text-sm text-gray-400 mt-2"},"支持 JPG、PNG 格式",-1))])):I("",!0)]),_:1}),v.value?(g(),_("div",te,[a(l,{class:"is-loading",size:24},{default:s(()=>[a(k(T))]),_:1}),e[5]||(e[5]=i("div",{class:"text-gray-600"},"正在处理图片...",-1))])):n.value?(g(),_("div",ae,[a(P,{title:n.value,type:"error",closable:!1},null,8,["title"]),a(w,{type:"primary",onClick:e[0]||(e[0]=p=>n.value="")},{default:s(()=>e[6]||(e[6]=[f(" 重试 ")])),_:1})])):u.value?(g(),_("div",le,[a(R,{src:u.value,fit:"contain"},null,8,["src"]),a(M,null,{default:s(()=>[a(B,{label:"缩放比例",style:{"min-width":"400px"}},{default:s(()=>[a(A,{gutter:"{20}",style:{width:"100%"}},{default:s(()=>[a(y,{span:18},{default:s(()=>[a(V,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=p=>c.value=p),min:1,max:100,"format-tooltip":p=>`${p}%`,onInput:z},null,8,["modelValue","format-tooltip"])]),_:1}),a(y,{span:5,offset:1,class:"text-right"},{default:s(()=>[i("span",oe,W(c.value)+"%",1)]),_:1})]),_:1})]),_:1}),a(w,{type:"primary",onClick:F},{default:s(()=>e[7]||(e[7]=[f(" 下载调整后的图片 ")])),_:1})]),_:1})])):I("",!0)]),_:1})])}}},ve=D(ne,[["__scopeId","data-v-5012d956"]]);export{ve as default};
