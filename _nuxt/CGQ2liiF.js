import{_ as D,r,t as _,z as a,A as s,v as g,am as I,x as i,aG as G,a8 as k,bb as L,B as f,aT as T,bc as J,bd as O,y as W}from"./BgcB-hOa.js";import{E as $,w as j,z as H,x as X,y as Z}from"./C6gQdffp.js";import{E as q}from"./5ALttNZ2.js";import{E as K}from"./SO6lA4p9.js";import{E as Q}from"./Bzmzx-cn.js";import"./DEztFZNs.js";const Y={class:"container"},ee={key:0,class:"text-center"},te={key:0,class:"text-center"},ae={key:1,class:"text-center"},le={key:2,class:"image-container text-center"},oe={class:"text-gray-600"},se=10*1024*1024,ne={__name:"resize",setup(re){r(null);const u=r(""),x=r(""),c=r(100),d=r(0),m=r(0),w=r(0),E=r(0),v=r(!1),n=r(""),b=["image/jpeg","image/png","image/webp"],C=t=>{const e=t.raw;e&&z(e)},U=t=>b.includes(t.type)?t.size>se?(n.value="图片大小不能超过 10MB",!1):(n.value="",!0):(n.value="请上传 JPG、PNG 或 WebP 格式的图片",!1),z=t=>{if(!U(t))return;v.value=!0,n.value="";const e=new FileReader;e.onload=l=>{const o=new Image;o.onload=()=>{w.value=o.width,E.value=o.height,d.value=o.width,m.value=o.height,c.value=100,v.value=!1},o.onerror=()=>{n.value="图片加载失败，请重试",v.value=!1},o.src=l.target.result,u.value=l.target.result,x.value=l.target.result},e.onerror=()=>{n.value="图片读取失败，请重试",v.value=!1},e.readAsDataURL(t)},F=()=>{d.value=Math.round(w.value*c.value/100),m.value=Math.round(E.value*c.value/100);const t=document.createElement("canvas");t.width=d.value,t.height=m.value;const e=t.getContext("2d"),l=new Image;l.onload=()=>{e.drawImage(l,0,0,d.value,m.value),u.value=t.toDataURL("image/png")},l.src=x.value},P=()=>{const t=document.createElement("canvas");t.width=d.value,t.height=m.value;const e=t.getContext("2d"),l=new Image;l.onload=()=>{e.drawImage(l,0,0,d.value,m.value);const o=document.createElement("a");o.download="resized-image.png",o.href=t.toDataURL("image/png"),o.click()},l.src=u.value};return(t,e)=>{const l=G,o=j,R=q,h=H,S=K,V=Q,y=O,B=J,M=Z,N=X,A=$;return g(),_("div",Y,[a(A,null,{header:s(()=>e[2]||(e[2]=[i("div",{class:"text-center"},[i("span",{class:"text-xl font-medium"},"图片缩放")],-1)])),default:s(()=>[a(o,{class:"upload-area",drag:"","auto-upload":!1,"show-file-list":!1,accept:"image/*","on-change":C},{trigger:s(()=>[!u.value&&!v.value&&!n.value?(g(),_("div",ee,[a(l,{class:"el-icon--upload mx-auto block"},{default:s(()=>[a(k(L))]),_:1}),e[3]||(e[3]=i("div",{class:"el-upload__text"},[f(" 拖拽图片到此处或 "),i("em",null,"点击上传")],-1)),e[4]||(e[4]=i("div",{class:"text-sm text-gray-400 mt-2"},"支持 JPG、PNG 格式",-1))])):I("",!0)]),_:1}),v.value?(g(),_("div",te,[a(l,{class:"is-loading",size:24},{default:s(()=>[a(k(T))]),_:1}),e[5]||(e[5]=i("div",{class:"text-gray-600"},"正在处理图片...",-1))])):n.value?(g(),_("div",ae,[a(R,{title:n.value,type:"error",closable:!1},null,8,["title"]),a(h,{type:"primary",onClick:e[0]||(e[0]=p=>n.value="")},{default:s(()=>e[6]||(e[6]=[f(" 重试 ")])),_:1})])):u.value?(g(),_("div",le,[a(S,{src:u.value,fit:"contain"},null,8,["src"]),a(N,null,{default:s(()=>[a(M,{label:"缩放比例",style:{"min-width":"400px"}},{default:s(()=>[a(B,{gutter:"{20}",style:{width:"100%"}},{default:s(()=>[a(y,{span:18},{default:s(()=>[a(V,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=p=>c.value=p),min:1,max:100,"format-tooltip":p=>`${p}%`,onInput:F},null,8,["modelValue","format-tooltip"])]),_:1}),a(y,{span:5,offset:1,class:"text-right"},{default:s(()=>[i("span",oe,W(c.value)+"%",1)]),_:1})]),_:1})]),_:1}),a(h,{type:"primary",onClick:P},{default:s(()=>e[7]||(e[7]=[f(" 下载调整后的图片 ")])),_:1})]),_:1})])):I("",!0)]),_:1})])}}},_e=D(ne,[["__scopeId","data-v-e548e2dc"]]);export{_e as default};
